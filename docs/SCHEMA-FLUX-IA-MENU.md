# ğŸ¨ SCHÃ‰MA VISUEL - FLUX DE GÃ‰NÃ‰RATION DE MENU PAR IA

## ğŸ“ Architecture Globale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ğŸ“ PAGE Ã‰COLE (Frontend)                      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ“ Formulaire     â”‚  â”‚  ğŸ‘¥ Groupes d'Ã¢ge  â”‚  â”‚  ğŸ½ï¸ Options â”‚ â”‚
â”‚  â”‚  - Type Ã©tabl.     â”‚  â”‚  - Maternelle: 30  â”‚  â”‚  - AllergÃ¨nesâ”‚ â”‚
â”‚  â”‚  - Nb plats: 3     â”‚  â”‚  - Primaire: 50    â”‚  â”‚  - RÃ©gimes   â”‚ â”‚
â”‚  â”‚  - ThÃ¨me: Printempsâ”‚  â”‚  - CollÃ¨ge: 40     â”‚  â”‚  - Texture   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸ POST /api/intelligent-menu/generate       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ–¥ï¸ BACKEND - ContrÃ´leur (Node.js)               â”‚
â”‚                                                                     â”‚
â”‚  Ã‰TAPE 1 : Analyse des donnÃ©es                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  âœ… Total convives: 120 enfants                             â”‚  â”‚
â”‚  â”‚  âœ… Groupe majoritaire: Primaire CP-CE1 (50 enfants)        â”‚  â”‚
â”‚  â”‚  âœ… AllergÃ¨nes Ã  Ã©viter: gluten, lactose                    â”‚  â”‚
â”‚  â”‚  âœ… RÃ©gimes: vÃ©gÃ©tarien, halal                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸                                            â”‚
â”‚                                                                     â”‚
â”‚  Ã‰TAPE 2 : Construction des filtres MongoDB                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  {                                                           â”‚  â”‚
â”‚  â”‚    allergens: { $nin: ["gluten", "lactose"] },              â”‚  â”‚
â”‚  â”‚    establishmentType: { $in: ["ecole", "collectivite"] },   â”‚  â”‚
â”‚  â”‚    $or: [                                                    â”‚  â”‚
â”‚  â”‚      { diet: { $in: ["vegetarien", "halal"] } }             â”‚  â”‚
â”‚  â”‚    ],                                                        â”‚  â”‚
â”‚  â”‚    texture: "normale"                                        â”‚  â”‚
â”‚  â”‚  }                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ—„ï¸ BASE DE DONNÃ‰ES MongoDB                        â”‚
â”‚                                                                     â”‚
â”‚  Collection: RecipeEnriched (510 recettes)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“Š RECHERCHE :                                             â”‚  â”‚
â”‚  â”‚  510 recettes â†’ Filtres â†’ 150 recettes compatibles         â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Recettes gardÃ©es :                                         â”‚  â”‚
â”‚  â”‚  âœ… Sans gluten ET sans lactose                            â”‚  â”‚
â”‚  â”‚  âœ… Ã‰tablissement: Ã©cole ou collectivitÃ©                   â”‚  â”‚
â”‚  â”‚  âœ… RÃ©gime vÃ©gÃ©tarien OU halal                             â”‚  â”‚
â”‚  â”‚  âœ… Texture normale                                        â”‚  â”‚
â”‚  â”‚  âœ… Tranche d'Ã¢ge compatible (6-12 ans)                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸ 150 recettes                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ğŸ¤– INTELLIGENCE ARTIFICIELLE (OpenAI)              â”‚
â”‚                                                                     â”‚
â”‚  ModÃ¨le : GPT-4o                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“ PROMPT SYSTÃˆME :                                        â”‚  â”‚
â”‚  â”‚  "Tu es un chef expert en nutrition scolaire.               â”‚  â”‚
â”‚  â”‚   Compose un menu Ã‰QUILIBRÃ‰ pour enfants..."                â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ“ PROMPT UTILISATEUR :                                    â”‚  â”‚
â”‚  â”‚  "Compose un menu sur le thÃ¨me Printemps                    â”‚  â”‚
â”‚  â”‚   pour 120 enfants (3 groupes d'Ã¢ge).                       â”‚  â”‚
â”‚  â”‚   Choisis 3 recettes parmi ces 150 options..."             â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ“‹ RECETTES FOURNIES (max 40 pour limites tokens) :       â”‚  â”‚
â”‚  â”‚  [                                                          â”‚  â”‚
â”‚  â”‚    {id: "68ece...", title: "Salade carottes",...},          â”‚  â”‚
â”‚  â”‚    {id: "68ece...", title: "Poulet rÃ´ti",...},              â”‚  â”‚
â”‚  â”‚    {id: "68ece...", title: "Compote pommes",...},           â”‚  â”‚
â”‚  â”‚    ...                                                      â”‚  â”‚
â”‚  â”‚  ]                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸ Traitement IA (3-5 secondes)              â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¯ RÃ‰PONSE IA (format JSON) :                              â”‚  â”‚
â”‚  â”‚  {                                                           â”‚  â”‚
â”‚  â”‚    "title": "Menu Printanier Ã‰quilibrÃ©",                    â”‚  â”‚
â”‚  â”‚    "description": "Menu colorÃ© avec lÃ©gumes de saison...",  â”‚  â”‚
â”‚  â”‚    "selectedRecipeIds": [                                   â”‚  â”‚
â”‚  â”‚      "68ece0eea5b41c48e9064216",  // Salade carottes       â”‚  â”‚
â”‚  â”‚      "68ece0eea5b41c48e906423a",  // Poulet rÃ´ti           â”‚  â”‚
â”‚  â”‚      "68ece0eea5b41c48e9064298"   // Compote pommes        â”‚  â”‚
â”‚  â”‚    ],                                                       â”‚  â”‚
â”‚  â”‚    "ageAdaptation": "Portions adaptÃ©es : Maternelle 70%..." â”‚  â”‚
â”‚  â”‚  }                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ½ï¸ BACKEND - Composition du menu final                â”‚
â”‚                                                                     â”‚
â”‚  Ã‰TAPE 3 : RÃ©cupÃ©ration des recettes complÃ¨tes                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  3 recettes sÃ©lectionnÃ©es par l'IA :                        â”‚  â”‚
â”‚  â”‚  - Salade de carottes rÃ¢pÃ©es (entrÃ©e)                       â”‚  â”‚
â”‚  â”‚  - Poulet rÃ´ti avec lÃ©gumes (plat)                          â”‚  â”‚
â”‚  â”‚  - Compote de pommes (dessert)                              â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Chaque recette contient :                                  â”‚  â”‚
â”‚  â”‚  âœ… IngrÃ©dients dÃ©taillÃ©s (quantitÃ©s, unitÃ©s)              â”‚  â”‚
â”‚  â”‚  âœ… Instructions de prÃ©paration (Ã©tapes)                   â”‚  â”‚
â”‚  â”‚  âœ… Valeurs nutritionnelles (kcal, protÃ©ines, etc.)        â”‚  â”‚
â”‚  â”‚  âœ… Texture, catÃ©gorie, description                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸                                            â”‚
â”‚                                                                     â”‚
â”‚  Ã‰TAPE 4 : Calcul des portions par groupe d'Ã¢ge                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“Š MULTIPLICATEURS DE PORTIONS :                           â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Groupe 1 : Maternelle (30 enfants)                        â”‚  â”‚
â”‚  â”‚  â””â”€â–º Multiplicateur : 0.7 (70% d'une portion standard)     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Groupe 2 : Primaire CP-CE1 (50 enfants)                   â”‚  â”‚
â”‚  â”‚  â””â”€â–º Multiplicateur : 1.0 (100% = portion de rÃ©fÃ©rence)    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Groupe 3 : CollÃ¨ge (40 enfants)                           â”‚  â”‚
â”‚  â”‚  â””â”€â–º Multiplicateur : 1.3 (130% = portion augmentÃ©e)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚                        â¬‡ï¸                                            â”‚
â”‚                                                                     â”‚
â”‚  Ã‰TAPE 5 : GÃ©nÃ©ration de la liste de courses                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“ CALCUL DES QUANTITÃ‰S TOTALES :                          â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Carottes (pour Salade + Poulet rÃ´ti) :                    â”‚  â”‚
â”‚  â”‚  â€¢ Maternelle : 2kg Ã— 0.7 Ã— 30 = 4.2 kg                    â”‚  â”‚
â”‚  â”‚  â€¢ Primaire   : 2kg Ã— 1.0 Ã— 50 = 10.0 kg                   â”‚  â”‚
â”‚  â”‚  â€¢ CollÃ¨ge    : 2kg Ã— 1.3 Ã— 40 = 10.4 kg                   â”‚  â”‚
â”‚  â”‚  â””â”€â–º TOTAL : 24.6 kg de carottes                           â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Poulet (pour Poulet rÃ´ti) :                                â”‚  â”‚
â”‚  â”‚  â€¢ Maternelle : 100g Ã— 0.7 Ã— 30 = 2.1 kg                   â”‚  â”‚
â”‚  â”‚  â€¢ Primaire   : 100g Ã— 1.0 Ã— 50 = 5.0 kg                   â”‚  â”‚
â”‚  â”‚  â€¢ CollÃ¨ge    : 100g Ã— 1.3 Ã— 40 = 5.2 kg                   â”‚  â”‚
â”‚  â”‚  â””â”€â–º TOTAL : 12.3 kg de poulet                             â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ... (calcul similaire pour tous les ingrÃ©dients)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ğŸ“¤ RÃ‰PONSE JSON COMPLÃˆTE AU FRONTEND               â”‚
â”‚                                                                     â”‚
â”‚  {                                                                  â”‚
â”‚    "success": true,                                                 â”‚
â”‚    "menu": {                                                        â”‚
â”‚      "title": "Menu Printanier Ã‰quilibrÃ©",                          â”‚
â”‚      "description": "Menu colorÃ© avec lÃ©gumes de saison...",        â”‚
â”‚                                                                     â”‚
â”‚      "mainMenu": {                                                  â”‚
â”‚        "dishes": [                                                  â”‚
â”‚          {                                                          â”‚
â”‚            "name": "Salade de carottes rÃ¢pÃ©es",                     â”‚
â”‚            "category": "entrÃ©e",                                    â”‚
â”‚            "ingredients": [{name:"Carottes",quantity:2,unit:"kg"}], â”‚
â”‚            "nutritionalProfile": {kcal:85, protein:2, carbs:12},    â”‚
â”‚            "preparationSteps": ["Laver les carottes", "RÃ¢per",...] â”‚
â”‚          },                                                         â”‚
â”‚          { "name": "Poulet rÃ´ti avec lÃ©gumes", ... },               â”‚
â”‚          { "name": "Compote de pommes", ... }                       â”‚
â”‚        ]                                                            â”‚
â”‚      },                                                             â”‚
â”‚                                                                     â”‚
â”‚      "variants": [                                                  â”‚
â”‚        {                                                            â”‚
â”‚          "ageRange": "maternelle",                                  â”‚
â”‚          "count": 30,                                               â”‚
â”‚          "portionMultiplier": 0.7,                                  â”‚
â”‚          "dishes": [/* mÃªmes plats, quantitÃ©s Ã— 0.7 */]             â”‚
â”‚        },                                                           â”‚
â”‚        {                                                            â”‚
â”‚          "ageRange": "primaire_cp_ce1",                             â”‚
â”‚          "count": 50,                                               â”‚
â”‚          "portionMultiplier": 1.0,                                  â”‚
â”‚          "dishes": [/* portions standards */]                       â”‚
â”‚        },                                                           â”‚
â”‚        {                                                            â”‚
â”‚          "ageRange": "college",                                     â”‚
â”‚          "count": 40,                                               â”‚
â”‚          "portionMultiplier": 1.3,                                  â”‚
â”‚          "dishes": [/* portions augmentÃ©es */]                      â”‚
â”‚        }                                                            â”‚
â”‚      ],                                                             â”‚
â”‚                                                                     â”‚
â”‚      "shoppingList": [                                              â”‚
â”‚        {                                                            â”‚
â”‚          "name": "Carottes",                                        â”‚
â”‚          "quantity": 24.6,                                          â”‚
â”‚          "unit": "kg",                                              â”‚
â”‚          "requiredFor": ["Salade carottes", "Poulet rÃ´ti"]         â”‚
â”‚        },                                                           â”‚
â”‚        {                                                            â”‚
â”‚          "name": "Poulet",                                          â”‚
â”‚          "quantity": 12.3,                                          â”‚
â”‚          "unit": "kg",                                              â”‚
â”‚          "requiredFor": ["Poulet rÃ´ti avec lÃ©gumes"]               â”‚
â”‚        },                                                           â”‚
â”‚        // ... autres ingrÃ©dients                                   â”‚
â”‚      ]                                                              â”‚
â”‚    }                                                                â”‚
â”‚  }                                                                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚
                                    â¬‡ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ¨ AFFICHAGE FRONTEND (Page Ã‰cole)                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“‹ MENU PRINTANIER Ã‰QUILIBRÃ‰                               â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ¥— ENTRÃ‰E : Salade de carottes rÃ¢pÃ©es                      â”‚  â”‚
â”‚  â”‚  â€¢ Description : Salade fraÃ®che et croquante...             â”‚  â”‚
â”‚  â”‚  â€¢ Nutrition : 85 kcal, 2g protÃ©ines, 12g glucides          â”‚  â”‚
â”‚  â”‚  â€¢ IngrÃ©dients : 2 kg de carottes, citron, huile...         â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ— PLAT : Poulet rÃ´ti avec lÃ©gumes                         â”‚  â”‚
â”‚  â”‚  â€¢ Description : Poulet tendre avec accompagnement...       â”‚  â”‚
â”‚  â”‚  â€¢ Nutrition : 420 kcal, 35g protÃ©ines, 25g glucides        â”‚  â”‚
â”‚  â”‚  â€¢ IngrÃ©dients : 100g poulet, carottes, pommes de terre...  â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ DESSERT : Compote de pommes                             â”‚  â”‚
â”‚  â”‚  â€¢ Description : Compote onctueuse maison...                â”‚  â”‚
â”‚  â”‚  â€¢ Nutrition : 95 kcal, 0.5g protÃ©ines, 22g glucides        â”‚  â”‚
â”‚  â”‚  â€¢ IngrÃ©dients : 150g pommes, sucre, cannelle...            â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚  ğŸ‘¥ ADAPTATIONS PAR GROUPE :                                â”‚  â”‚
â”‚  â”‚  â€¢ 30 Maternelle â†’ portions Ã  70%                           â”‚  â”‚
â”‚  â”‚  â€¢ 50 Primaire CP-CE1 â†’ portions standards 100%             â”‚  â”‚
â”‚  â”‚  â€¢ 40 CollÃ¨ge â†’ portions augmentÃ©es 130%                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  ğŸ›’ LISTE DE COURSES (pour 120 convives) :                  â”‚  â”‚
â”‚  â”‚  â€¢ Carottes : 24.6 kg                                       â”‚  â”‚
â”‚  â”‚  â€¢ Poulet : 12.3 kg                                         â”‚  â”‚
â”‚  â”‚  â€¢ Pommes : 8.5 kg                                          â”‚  â”‚
â”‚  â”‚  â€¢ ... (liste complÃ¨te)                                     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  [ğŸ“¥ TÃ©lÃ©charger PDF]  [ğŸ›’ Commander]  [ğŸ’¾ Sauvegarder]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUX SIMPLIFIÃ‰

```
Utilisateur
    â”‚
    â”œâ”€â–º 1. Remplit formulaire (groupes d'Ã¢ge, restrictions)
    â”‚
    â¬‡
Backend
    â”‚
    â”œâ”€â–º 2. Filtre 510 recettes â†’ 150 compatibles (MongoDB)
    â”‚
    â¬‡
IA (GPT-4o)
    â”‚
    â”œâ”€â–º 3. SÃ©lectionne 3 recettes optimales (Ã©quilibre nutritionnel)
    â”‚
    â¬‡
Backend
    â”‚
    â”œâ”€â–º 4. Calcule portions par groupe d'Ã¢ge
    â”œâ”€â–º 5. GÃ©nÃ¨re liste de courses
    â”‚
    â¬‡
Frontend
    â”‚
    â””â”€â–º 6. Affiche menu complet + liste de courses
```

---

## â±ï¸ TEMPS DE TRAITEMENT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ã‰TAPE               â”‚ TEMPS        â”‚ COMPOSANT       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Envoi formulaire    â”‚ < 0.1s       â”‚ Frontend        â”‚
â”‚ Filtrage recettes   â”‚ 0.5-1s       â”‚ MongoDB         â”‚
â”‚ SÃ©lection IA        â”‚ 3-5s         â”‚ OpenAI GPT-4o   â”‚
â”‚ Calculs portions    â”‚ 0.2-0.5s     â”‚ Backend         â”‚
â”‚ Affichage menu      â”‚ < 0.1s       â”‚ Frontend        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL               â”‚ 4-7 secondes â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ CRITÃˆRES DE SÃ‰LECTION DE L'IA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ğŸ§  INTELLIGENCE DE SÃ‰LECTION                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  1ï¸âƒ£ Ã‰QUILIBRE NUTRITIONNEL (Poids: 40%)              â”‚
â”‚     â€¢ ProtÃ©ines + Glucides + Lipides bien rÃ©partis   â”‚
â”‚     â€¢ Apport calorique adaptÃ© Ã  l'Ã¢ge                â”‚
â”‚     â€¢ PrÃ©sence de lÃ©gumes et fibres                  â”‚
â”‚                                                       â”‚
â”‚  2ï¸âƒ£ VARIÃ‰TÃ‰ (Poids: 25%)                             â”‚
â”‚     â€¢ Pas de rÃ©pÃ©tition d'ingrÃ©dients principaux     â”‚
â”‚     â€¢ DiversitÃ© des textures et couleurs             â”‚
â”‚     â€¢ Alternance chaud/froid                         â”‚
â”‚                                                       â”‚
â”‚  3ï¸âƒ£ ADAPTATION Ã€ L'Ã‚GE (Poids: 20%)                  â”‚
â”‚     â€¢ Plats adaptÃ©s aux prÃ©fÃ©rences enfants          â”‚
â”‚     â€¢ FacilitÃ© de mastication et dÃ©glutition         â”‚
â”‚     â€¢ PrÃ©sentation attractive                        â”‚
â”‚                                                       â”‚
â”‚  4ï¸âƒ£ RESPECT DES CONTRAINTES (Poids: 15%)             â”‚
â”‚     â€¢ Aucun allergÃ¨ne interdit                       â”‚
â”‚     â€¢ ConformitÃ© aux rÃ©gimes (vÃ©gÃ©tarien, halal...)  â”‚
â”‚     â€¢ Texture appropriÃ©e (normale, mixÃ©e...)         â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” EXEMPLE DE DÃ‰CISION IA

**Contexte** : Menu pour Ã©cole, 120 enfants, thÃ¨me Printemps, pas de gluten

**Recettes disponibles** : 35 options aprÃ¨s filtrage

**Processus de l'IA** :

```
Analyse des 35 recettes :
â”œâ”€â–º CatÃ©gorie "entrÃ©e" : 8 options
â”‚   â””â”€â–º SÃ©lection : "Salade de carottes" âœ…
â”‚       Raison : LÃ©gÃ¨re, colorÃ©e, apport fibres, sans gluten
â”‚
â”œâ”€â–º CatÃ©gorie "plat" : 18 options
â”‚   â””â”€â–º SÃ©lection : "Poulet rÃ´ti lÃ©gumes" âœ…
â”‚       Raison : ProtÃ©ines, lÃ©gumes de saison, populaire auprÃ¨s enfants
â”‚
â””â”€â–º CatÃ©gorie "dessert" : 9 options
    â””â”€â–º SÃ©lection : "Compote pommes" âœ…
        Raison : LÃ©ger, fruitÃ©, facile Ã  digÃ©rer, sans gluten
```

**VÃ©rifications finales de l'IA** :
- âœ… Ã‰quilibre : ProtÃ©ines (poulet) + Glucides (lÃ©gumes) + Fibres (carottes, pommes)
- âœ… Pas de rÃ©pÃ©tition : carottes utilisÃ©es dans 2 plats mais de faÃ§on diffÃ©rente
- âœ… Couleurs : Orange (carottes), DorÃ© (poulet), Jaune (pommes)
- âœ… ThÃ¨me Printemps : LÃ©gumes frais, plats lÃ©gers

---

âœ… **La logique est maintenant complÃ¨tement documentÃ©e avec schÃ©mas visuels !**

