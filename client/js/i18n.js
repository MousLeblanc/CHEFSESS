// Système de traduction i18n pour Chef SES
// Support FR/EN/NL

const translations = {
  fr: {
    nav: {
      home: 'Accueil',
      features: 'Fonctionnalités',
      about: 'À propos',
      collectivites: 'Collectivités',
      suppliers: 'Fournisseurs',
      contact: 'Contact',
      demo: 'Démo',
      login: 'Connexion'
    },
    hero: {
      title: 'Chef SES',
      subtitle: 'La plateforme intelligente qui connecte menus, stocks et fournisseurs pour les écoles, hôpitaux et maisons de retraite.',
      tryDemo: 'Essayer la démo',
      joinPilot: 'Rejoindre le programme pilote'
    },
    features: {
      title: 'Fonctionnalités Principales',
      subtitle: 'Tout ce dont vous avez besoin pour gérer efficacement votre restauration collective',
      aiMenu: {
        title: 'Générateur de Menus IA',
        desc: 'Création automatique de menus basée sur les allergies, la nutrition et le stock disponible.'
      },
      stock: {
        title: 'Gestion Intelligente du Stock',
        desc: 'Suivi en temps réel des ingrédients, dates d\'expiration et livraisons fournisseurs.'
      },
      multiSite: {
        title: 'Gestion Multi-Sites',
        desc: 'Contrôlez plusieurs cuisines — écoles, hôpitaux, EHPAD — depuis un seul tableau de bord.'
      },
      residents: {
        title: 'Profils Résidents',
        desc: 'Gestion des profils nutritionnels, allergies et restrictions alimentaires individuelles.'
      },
      foodCost: {
        title: 'Food Cost & Budget',
        desc: 'Suivi des coûts alimentaires, analyse des dépenses et optimisation du budget.'
      },
      suppliers: {
        title: 'Réseau de Fournisseurs',
        desc: 'Commandes simplifiées, catalogues numériques et coordination avec vos partenaires.'
      }
    },
    about: {
      title: 'À propos de Chef SES',
      description: 'Chef SES est une plateforme web complète qui simplifie la gestion de la restauration collective. Elle centralise les profils nutritionnels, la génération de menus, le contrôle des stocks et la coordination avec les fournisseurs — permettant aux chefs et aux équipes de santé de se concentrer sur l\'essentiel : des repas sains et équilibrés.',
      values: {
        innovation: 'Innovation',
        sustainability: 'Durabilité',
        health: 'Santé'
      }
    },
    contact: {
      title: 'Contactez-nous',
      subtitle: 'Intéressé par un partenariat, un test ou un investissement ?',
      name: 'Votre nom',
      email: 'Votre email',
      message: 'Votre message',
      send: 'Envoyer le message'
    },
    footer: {
      copyright: '© 2025 Chef SES',
      tagline: 'Less is More'
    }
  },
  en: {
    nav: {
      home: 'Home',
      features: 'Features',
      about: 'About',
      collectivites: 'Communities',
      suppliers: 'Suppliers',
      contact: 'Contact',
      demo: 'Demo',
      login: 'Login'
    },
    hero: {
      title: 'Chef SES',
      subtitle: 'The intelligent catering platform connecting menus, stocks, and suppliers for schools, hospitals, and care homes.',
      tryDemo: 'Try Demo',
      joinPilot: 'Join Pilot Program'
    },
    features: {
      title: 'Core Features',
      subtitle: 'Everything you need to efficiently manage your collective catering',
      aiMenu: {
        title: 'AI Menu Generator',
        desc: 'Automatic menu creation based on allergies, nutrition, and available stock.'
      },
      stock: {
        title: 'Smart Stock Management',
        desc: 'Real-time tracking of ingredients, expiration dates, and supplier deliveries.'
      },
      multiSite: {
        title: 'Multi-Site Management',
        desc: 'Control multiple kitchens — schools, hospitals, care homes — from one dashboard.'
      },
      residents: {
        title: 'Resident Profiles',
        desc: 'Management of nutritional profiles, allergies, and individual dietary restrictions.'
      },
      foodCost: {
        title: 'Food Cost & Budget',
        desc: 'Track food costs, analyze expenses, and optimize budget.'
      },
      suppliers: {
        title: 'Supplier Network',
        desc: 'Simplified orders, digital catalogs, and coordination with your partners.'
      }
    },
    about: {
      title: 'About Chef SES',
      description: 'Chef SES is a complete web platform that simplifies collective catering management. It centralizes nutritional profiles, menu generation, stock control, and supplier coordination — empowering chefs and healthcare teams to focus on what matters most: healthy, balanced meals.',
      values: {
        innovation: 'Innovation',
        sustainability: 'Sustainability',
        health: 'Health'
      }
    },
    contact: {
      title: 'Get in Touch',
      subtitle: 'Interested in partnering, testing, or investing?',
      name: 'Your name',
      email: 'Your email',
      message: 'Your message',
      send: 'Send Message'
    },
    footer: {
      copyright: '© 2025 Chef SES',
      tagline: 'Less is More'
    }
  },
  nl: {
    nav: {
      home: 'Home',
      features: 'Functies',
      about: 'Over ons',
      collectivites: 'Collectiviteiten',
      suppliers: 'Leveranciers',
      contact: 'Contact',
      demo: 'Demo',
      login: 'Inloggen'
    },
    hero: {
      title: 'Chef SES',
      subtitle: 'Het intelligente cateringplatform dat menus, voorraden en leveranciers verbindt voor scholen, ziekenhuizen en zorginstellingen.',
      tryDemo: 'Probeer demo',
      joinPilot: 'Doe mee met pilootprogramma'
    },
    features: {
      title: 'Hoofdfuncties',
      subtitle: 'Alles wat u nodig heeft om uw collectieve catering efficiënt te beheren',
      aiMenu: {
        title: 'AI Menu Generator',
        desc: 'Automatische menucreatie op basis van allergieën, voeding en beschikbare voorraad.'
      },
      stock: {
        title: 'Slimme Voorraadbeheer',
        desc: 'Realtime tracking van ingrediënten, vervaldatums en leveranciersleveringen.'
      },
      multiSite: {
        title: 'Multi-Site Beheer',
        desc: 'Beheer meerdere keukens — scholen, ziekenhuizen, zorginstellingen — vanaf één dashboard.'
      },
      residents: {
        title: 'Bewonerprofielen',
        desc: 'Beheer van voedingsprofielen, allergieën en individuele dieetbeperkingen.'
      },
      foodCost: {
        title: 'Voedselkosten & Budget',
        desc: 'Volg voedselkosten, analyseer uitgaven en optimaliseer budget.'
      },
      suppliers: {
        title: 'Leveranciersnetwerk',
        desc: 'Vereenvoudigde bestellingen, digitale catalogi en coördinatie met uw partners.'
      }
    },
    about: {
      title: 'Over Chef SES',
      description: 'Chef SES is een compleet webplatform dat collectieve cateringbeheer vereenvoudigt. Het centraliseert voedingsprofielen, menu-generatie, voorraadbeheer en leverancierscoördinatie — waardoor chefs en gezondheidsteams zich kunnen concentreren op wat het belangrijkst is: gezonde, uitgebalanceerde maaltijden.',
      values: {
        innovation: 'Innovatie',
        sustainability: 'Duurzaamheid',
        health: 'Gezondheid'
      }
    },
    contact: {
      title: 'Neem contact op',
      subtitle: 'Geïnteresseerd in samenwerking, testen of investeren?',
      name: 'Uw naam',
      email: 'Uw e-mail',
      message: 'Uw bericht',
      send: 'Bericht verzenden'
    },
    footer: {
      copyright: '© 2025 Chef SES',
      tagline: 'Less is More'
    }
  }
};

// Gestionnaire i18n
class I18n {
  constructor() {
    this.currentLang = localStorage.getItem('chefses-lang') || 'fr';
    this.init();
  }

  init() {
    // Définir la langue depuis l'URL ou le localStorage
    const urlParams = new URLSearchParams(window.location.search);
    const langParam = urlParams.get('lang');
    if (langParam && ['fr', 'en', 'nl'].includes(langParam)) {
      this.currentLang = langParam;
      localStorage.setItem('chefses-lang', this.currentLang);
    }
    
    this.translate();
    this.setupLanguageSwitcher();
  }

  translate() {
    const t = translations[this.currentLang];
    if (!t) return;

    // Traduire tous les éléments avec data-i18n
    document.querySelectorAll('[data-i18n]').forEach(element => {
      const key = element.getAttribute('data-i18n');
      const keys = key.split('.');
      let value = t;
      
      for (const k of keys) {
        value = value?.[k];
      }
      
      if (value !== undefined) {
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
          element.placeholder = value;
        } else {
          element.textContent = value;
        }
      }
    });

    // Mettre à jour l'attribut lang du HTML
    document.documentElement.lang = this.currentLang;
    
    // Mettre à jour le sélecteur de langue
    const langSwitcher = document.getElementById('lang-switcher');
    if (langSwitcher) {
      langSwitcher.value = this.currentLang;
    }
  }

  setupLanguageSwitcher() {
    const langSwitcher = document.getElementById('lang-switcher');
    if (langSwitcher) {
      langSwitcher.addEventListener('change', (e) => {
        this.currentLang = e.target.value;
        localStorage.setItem('chefses-lang', this.currentLang);
        
        // Mettre à jour l'URL avec le paramètre lang
        const url = new URL(window.location);
        url.searchParams.set('lang', this.currentLang);
        window.history.pushState({}, '', url);
        
        this.translate();
      });
    }
  }

  t(key) {
    const keys = key.split('.');
    let value = translations[this.currentLang];
    
    for (const k of keys) {
      value = value?.[k];
    }
    
    return value || key;
  }
}

// Initialiser i18n
const i18n = new I18n();

// Exposer globalement
window.i18n = i18n;

